cd C:/Users/Santiago/Documents/GitHub/Singular/Singular/LIB


// If we apply Hensel lifting up to the integrality exponent we are losing information,
// the Puiseux expansions cannot be recovered from the factors.

puiseuxList(I2Lifted[2], -1, 1, 2);  // Same Puiseux expansions

puiseuxList(fLoc, -1, 1, 2);  // Same Puiseux expansions

puiseuxList(comps[2], -1, 1, 2);  // Same Puiseux expansions

puiseuxList(f, -1, 1, 2);  // Same Puiseux expansions

with(algcurves);
f := 806777060*x^19*y^4+2132828650*x^19*y^3+247176605*x^18*y^4+1911143070*x^19*y^2+638584160*x^18*y^3+75543954*x^17*y^4+702000750*x^19*y+561549318*x^18*y^2+191032289*x^17*y^3+23056386*x^16*y^4+90075490*x^19+202647104*x^18*y+164930184*x^17*y^2+57138538*x^16*y^3+7034416*x^15*y^4+25531890*x^18+58459601*x^17*y+48444953*x^16*y^2+17100536*x^15*y^3+2147600*x^14*y^4+7226308*x^17+16858360*x^16*y+14239214*x^15*y^2+5125660*x^14*y^3+657010*x^13*y^4+2042242*x^16+4861166*x^15*y+4190490*x^14*y^2+1540085*x^13*y^3+201669*x^12*y^4+576277*x^15+1402035*x^14*y+1235599*x^13*y^2+464393*x^12*y^3+62224*x^11*y^4+162340*x^14+404559*x^13*y+365237*x^12*y^2+140617*x^11*y^3+19294*x^10*y^4+45650*x^13+116870*x^12*y+108420*x^11*y^2+42900*x^10*y^3+6050*x^9*y^4+12805*x^12+33800*x^11*y+32340*x^10*y^2+13200*x^9*y^3+1920*x^8*y^4+3580*x^11+9790*x^10*y+9710*x^9*y^2+4110*x^8*y^3+620*x^7*y^4+996*x^10+2840*x^9*y+2940*x^8*y^2+1300*x^7*y^3+205*x^6*y^4+275*x^9+825*x^8*y+900*x^7*y^2+420*x^6*y^3+70*x^5*y^4+75*x^8+240*x^7*y+280*x^6*y^2+140*x^5*y^3+25*x^4*y^4+20*x^7+70*x^6*y+90*x^5*y^2+50*x^4*y^3+10*x^3*y^4+5*x^6+20*x^5*y+30*x^4*y^2+20*x^3*y^3+5*x^2*y^4+x^5+5*x^4*y+10*x^3*y^2+10*x^2*y^3+5*x*y^4+y^5;
puiseux(expand(f),x=0,y,0);





LIB"integralbasis.lib";
ring R = 0, (x,y), dp;
poly h = 806777060x19y4+2132828650x19y3+247176605x18y4+1911143070x19y2+638584160x18y3+75543954x17y4+702000750x19y+561549318x18y2+191032289x17y3+23056386x16y4+90075490x19+202647104x18y+164930184x17y2+57138538x16y3+7034416x15y4+25531890x18+58459601x17y+48444953x16y2+17100536x15y3+2147600x14y4+7226308x17+16858360x16y+14239214x15y2+5125660x14y3+657010x13y4+2042242x16+4861166x15y+4190490x14y2+1540085x13y3+201669x12y4+576277x15+1402035x14y+1235599x13y2+464393x12y3+62224x11y4+162340x14+404559x13y+365237x12y2+140617x11y3+19294x10y4+45650x13+116870x12y+108420x11y2+42900x10y3+6050x9y4+12805x12+33800x11y+32340x10y2+13200x9y3+1920x8y4+3580x11+9790x10y+9710x9y2+4110x8y3+620x7y4+996x10+2840x9y+2940x8y2+1300x7y3+205x6y4+275x9+825x8y+900x7y2+420x6y3+70x5y4+75x8+240x7y+280x6y2+140x5y3+25x4y4+20x7+70x6y+90x5y2+50x4y3+10x3y4+5x6+20x5y+30x4y2+20x3y3+5x2y4+x5+5x4y+10x3y2+10x2y3+5xy4+y5;

poly h1 = 3533792453988321731188964010248710401629076457714454848968401363262163102832427003217945036723213896686008x44-30503144662498648124187700327814266662043956757384590762985361893140020949266097185746941988877796641412x43-10699918469962609579766422702526452193754662925538580442124907637406079209983670064593904045189288054x42-9478265178414407392524009598774524639179208028849370608674870593318073143115211314745201721652612267x41-6361833664242595682650253854102444455790893393071753353779930605833410489322130432999441786334107054x40y-3171831730557949952369290142914797020362304536313735729240854429649523985679876796613867541067682257x40-2284099755746733580810299937926600639383992426390172276586946468000330769111809105364501348408072081x39y-1142346512971029703866642660899824071662527976165175928447487564354871811153135121548139181894289284x39-925252716347225192490319348738642609629436628022257734425124765497570872738802118137362821982889719x38y-462620187477818447335346159924275700560323772112522723289142426821891599535050737766951218844115643x38-472295434824214131732935320451972821024598131630333351670883057782823998428209401913899730159367535x37y-236147778888114396010502020281645621130671186095648215569097265244732894548050986524295477610281464x37-492251541723392344592242147427726556560007550718807601798037398943743155725510544665930246243180419x36y-256412678187607900483038777917058927338560609524077346676740923654287385921162199711217516112584067x35y2+10286907325752074059094546449164148719554531763927099709746987677783568319688992814275594750711055x36+21204109763026482102914220709571779336201319094782725412411783515282722948488835510533733266705411x35y+10923496119153149535604523850298146365839652705597632778502338124839933230042426623175168210690057x34y2-321441237631960119301934824845997301116036585988352001492996909701801946648374202398842531102877x35-655592795901078338510922983315234154562692205948753031765905857200341189509801922554259062183949x34y-334213036709227480920929839463549070580563923868307568356329729501320368578394801349550495007532x33y2+6416638758406139227125144102128793128920426765482481982654390045180298837121544056851539259563x34+12956234397022045337465860113620043435772870092366741566419416415115053825304944796898953987158x33y+6539595638617755601392423660625645441268080418807326230042348911400194800599717692193356211698x32y2-61478440100368034663929622876737020137494169639554344413718068735183701788350699580240736126x33-122956880204297914820079968255230865962194990737646763993302758139447102284511969707185078171x32y-61478440103929880156173661940326621896550973437543869209452436789895342010192438186617835282x31y2+1712354440542170013223552641680053106937562403529151936398409957615576773742242604x32+3424708881126748121848471280767048207321357636572278548706054838998782765034344286x31y+1712354440584578219715720397464045569093719169384093831954020054925218613688015354x30y2-19511859822572886564424932682332330759232991775869912407661940116422589x31-39023979732253163942860846902952076209429162073119267894123770037112449x30y-19512141443274311633425565174171323928438039227813141767706798105036853x29y2+151603238821122053991535893386020547581542074759591251454856617564x30+352050113709639784565152838126463079945375523479478528554493375118x29y+203639604400892773777053593236101887053514716386191239615957911074x28y2-27616078254677150431806295814452377793851037087865986345132619430x29-62278950315375227478496948279593054249417250034839614906000324389x28y-35019593688971531847837277794665852225815145977848721108424021544x27y2+3880173737662704381562339648854785172076088477423963120528593109x28+8528962472854942454772677563061844637040961301331489603473862939x27y+4677904390094651641735792735976910397021625978599996532828060307x26y2-413424077890878110034075663046061671259104996641011469230278270x27-888249447179561425189819766734797427774103811284740883254196869x26y-476465566472120671145752645865512716242490263487309205399920031x25y2+32340842882125036510958104555251396895581775759318585835868322x26+68074341355075570225457286994934706232280459956942815008220986x25y+35790553310170439121558855716461605757473266964563496840833285x24y2-1753382632610998537356487554938132744665724391430423175579181x25-3622723390110060759492326548009353581549028800227035919955946x24y-1870264982724571685505769467185377832968356670641924303003947x23y2+58903287668060121825147836077931826791157664456833075466432x24+119655025787056775134421857801551822161955761005867567571810x23y+60751738119014778043963740058328176578633576712507578535004x22y2-924225225424704018371877728711466972857255693110845134863x23-1848450450883293410293158952351732069805393283829038823616x22y-924225225458589391921417620968447161438310333140905516495x21y2+15760638859996894595330978062665966881424367827x22+31521277720214846928901199550465111069845669000x21y+15760638860217952333315188010667460439296832204x20y2-94067122331231445543158381610631023x21-188134244045673477002277514929685192x20y-94067121647499921703096369196562639x19y2-362529862103013533834244988x20-847405048306817185397311596x19y-465963152433768249137403427x18y2+38359808256582764050378053x19-14159704608370982751133469x18y-91444439759303002729036666x17y2+84900565626462345120683764x18+280303369109751935114082239x17y+215601743634487742939742080x16y2-75478130986262047133180530x17-200171594851846366260187447x16y-129638168325371936045981627x15y2+29552370899449772812929534x16+70122250874420725844209500x15y+41162001959593309483901450x14y2-6100876522379164910255299x15-13442140827296644878721373x14y-7369336211566744905681496x13y2+648265797914861757281574x14+1352675409127324087488982x13y+704409611212797423744928x12y2-28071906648168088952742x13-56143813296838818202531x12y-28071906648670729228212x11y2+167546766277x12+335093501692x11y+167546741330x10y2+10842x11+12870x10y+3630x9y2+3234x10+3960x9y+1152x8y2+971x9+1233x8y+372x7y2+294x8+390x7y+123x6y2+90x7+126x6y+42x5y2+28x6+42x5y+15x4y2+9x5+15x4y+6x3y2+3x4+6x3y+3x2y2+x3+3x2y+3xy2+y3;
poly h2 = 3180916002650472619153119941955549661249391967248433257517253609602741336955357290730628071980091661x40+1142049877930914208128687133387794575535386395039879547290258515624420588187921440102455836301207007x39+462626358167493680244568423153072776676100294017983237077273488916903820101407832128317546251075150x38+236147717412631480502108870990228448157886556588788661199214554156178701854975137496722903980291642x37+246125770861660821841458223305490188849788774014574685028749000167756301723186599132222905036803584x36+256412678187607900483038777917058927338560609524077346676740923654287385921162199711217516112584067x35y-10602054881511435982756520702373830816198099438415461380654012964064660395845313269994531428025084x35-10923496119153149535604523850298146365839652705597632778502338124839933230042426623175168210690057x34y+327796397950473529080596869088499113110637091455088250751468967752253331644361657179456305622167x34+334213036709227480920929839463549070580563923868307568356329729501320368578394801349550495007532x33y-6478117198509507807855317159667396351995437589133389842644485270189202941638843749671053766747x33-6539595638617755601392423660625645441268080418807326230042348911400194800599717692193356211698x32y+61478440102132278632997262683768605024651160897630259425129295907445475673118915045170607534x32+61478440103929880156173661940326621896550973437543869209452436789895342010192438186617835282x31y-1712354440562876325843331707563072990306718804992217574992854416972425685792948361x31-1712354440584578219715720397464045569093719169384093831954020054925218613688015354x30y+19511989866120640505974364346320895074343381486841114310661449637618652x30+19512141443274311633425565174171323928438039227813141767706798105036853x29y-176025056854812915910881778427192575255618409269964250788584533050x29-203639604400892773777053593236101887053514716386191239615957911074x28y+31139475157685656797837375674534531804922281933743329690738625689x28+35019593688971531847837277794665852225815145977848721108424021544x27y-4264481236427070520030984143759245766578628565734697432566825016x27-4677904390094651641735792735976910397021625978599996532828060307x26y+444124723589720924936452658992291393062146397018791859909725193x26+476465566472120671145752645865512716242490263487309205399920031x25y-34037170677531438585596221050469628366708748263909238410938622x25-35790553310170439121558855716461605757473266964563221852760335x24y+1811361695054575411977748056942372176172016416947540728327664x24+1870264982724571685505769467185377832968356670642011418885347x23y-59827512893508613446358823394463578105086452626782181068226x23-60751738119014778043963740058328176578633576712480268126210x22y+924225225441252689174898876419810603905922560571218554067x22+924225225458589391921417620968447161438310333149397581923x21y-15760638860100368430214991805154450058514777744x21-15760638860217952333315188010667460436672980556x20y+94067122022794630641208107072154484x20+94067121647499921703096370003339699x19y+423702524153431583432934307x19+465963152433768249384580032x18y+7079852304197831669560736x18+91444439759303002804580620x17y-140151684554878793901786711x17-215601743634487742916685694x16y+100085797425923716227622089x16+129638168325371936053016043x15y-35061125437209574405695858x15-41162001959593309481753850x14y+6721070413646193673437436x14+7369336211566744906338506x13y-676337704562862299055084x13-704409611212797423543259x12y+28071906648335635852490x12+28071906648670729290436x11y-167546715691x11-167546722036x10y+4290x10+2420x9y+1320x9+768x8y+411x8+248x7y+130x7+82x6y+42x6+28x5y+14x5+10x4y+5x4+4x3y+2x3+2x2y+x2+2xy+y2;



LIB"integralbasis.lib";
ring R = 0, (x,y), dp;
poly g = (y11 - x2)*(y13-x3)+y25 + x25;
map phi = R,x+y^2-y^6, y+y^2+y^6;
poly gOrig = phi(g);
gOrig = substitute(gOrig, x, x+y);
gOrig = monic(gOrig);  


// We compare the Puiseux expansions
int xDegTrunc = 6;  // This is the minimum degree we can use for x-truncation
poly gTrunc = gOrig;
gTrunc = reduce(gTrunc, x^xDegTrunc);

list lTrunc = integralBasis(gTrunc, 2, "atOrigin", "opti1", "locBasis");

puiseuxList(gTrunc, -1, 1, 2);

henselBlocks(gTrunc, 30, 0);


// Here we need the factors developed up to degree 24, which is the sum of the x-degrees
list l = puiseux(gTrunc, -1, 1);
list classes = getClasses(l);
list bF = buildFactors(classes);

poly h2n = subst(h2, x, x2);
re = p1 - h2n;

poly f1 = x13+125x12+150x11+135x10+143x9+75x8y+87x8+60x7y+48x7+42x6y+28x6+42x5y+15x4y2+9x5+15x4y+6x3y2+3x4+6x3y+3x2y2+x3+3x2y+3xy2+y3;
poly f2 = x11+196x10+140x9+81x8+48x7+42x6+28x5y+14x5+10x4y+5x4+4x3y+2x3+2x2y+x2+2xy+y2;
poly h = f1*f2;


LIB"integralbasis.lib";
ring R = 0, (x,y), dp;
poly g = (y3 - x4)*(y3-x4 + x2y3)+y10;
list l = puiseux(g, -1, 1);
l;

list classes = getClasses(l);
list bF = buildFactors(classes);

puiseuxList(g, 2, -1);

list lTrunc = integralBasis(g, 2, "atOrigin", "opti1");
